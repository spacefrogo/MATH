#!/usr/bin/env python3

from math import exp, factorial
from sys import argv, stderr
from time import time

FAC_3500 = 239112819947764952509538749369364118451622972442875157035098986958774008856938009164464384478087712763885136836324995903067260002966232380317923569014472047378242172895901675784339742665174285098178725230385718873410201580175259254117313278842360350645709184329876569408534087247157506175662227323032268401542634192517467854833759108286982282738674218006164534722080501888701306745271156615964901119690613549677412733854731650212240291530230868963052062537322543685590156805381172101989286235672093708387076881037922024043169353754750563162564975919989156705752216537686413419886478328334225582677352517348762592223626234283533217638697510259891122288945333347625323222545748957592906614966809241762633225036129330067544428409130614279779458358460214091774376376215664910913970794811067270469967652614715681435650602502715659854784674080607387496034995432762102943225689288141047507603560274620671279571257838281286074602402041906666905816159021670503189274297808949147439617623366014081501493069928133829576787648903343040313232509102393480437849932578077767394100942315149628506552818743799625921142442362124547351414037615751471779736652223205335831101884838953461270406714479761343761829529415717067354982572153162056499332351496534919395456260862489220556391929537799748491137530902993971775367411959193353227311189697831964494769449670843907802573074824576081608675610481199282588487578559350540322964494404663070030692506188394549711904786110423992497711514194050568062254272683271646051852760242449079468426394832996212462317681562066382741991498626000186383919188586337690398358410097963645981845943904103085919424048994299893759272204944265425380208712118274687037863260425970808290349225602109349765322421587524344647276075819395262408247291619934400106749753204496533297982671006474886512509058393619675963813144770600333760258554927858026930214303998018311920138214403116873328516243009101282709378168128763134083498933248135008292020697142570120258463496139530911858597902005998388293598713907256245120494647249791194767950002069083717337203517611497367689838123580646742589214688623262086657195314694956264173960913196126575347297111534900392235253780359357395723416960087636892732601653435913589655681661131257542314802563320521926124631016660016670631805765230339783113346303061079421623485933949807597550717247283576354029169036445706661368363978891454093788861754877388285643999732690060073196923109774931897808506499739385218018130806086283707110373583923268832731842268387335657365983645758435193716613244708086319632331473439676389227246578621374920516638197276025186070290431547819378598206457381179918513602591753028571750812768661896258573878097533672909600504432905074504032787488476557745376205129311939566789495198515711967195965721096688722139223926262409157372945179391353801960869570473677279519248841966226107640765908289366757236930976816072169158914763313566025841439565275729568744308666068375364765026134557828994497475487073211245024320481189431901731952348993832023514078306594181237727326990681611787230334691773071082140130418864837407377482563748282701077068205455700742475673832247794060566473980574649932006300025913942848833255103806007258792664680321881824191292633223678721231203118509851044596098638994797499302637918284164533948517228669747178634804889803109452954402052504573099499450594295021921851474143098056182292492186027479704038452934649022459654314187653648534037397057687539703736792929786026713004505455090826922102864709390496711135355275763314468477762036156570779430502809114971166283166255476621707864979422497249592131377432891895184448581009546747527950992175979426863678480859427997624165454786036803881005859975960277235579547141674946691830545088826388583836581872893897178520784449451078496915707078562404155115356983243195289440474255734778268119173598515000453185167432649333662482010693585626949277301531045900057832659747360275395242399709845863488654118410177090473076884067477736030314775766242957455648726982066931404236966658061155534267293938052911367782062568795537771863706492864505774181666322768230930961097985043810236164862377493892870646480514311677190684582292569250882061405998697046298000581983089005403054965821821385890687800935039700099546719680766311967999076080734122049585837136778883359098710006874497288881165627579070612668123851619081732181725010529826662967133514067477484529702396859645143368651607811562489666874253608678366967264911457794131284921911551763270278708988387548759746722977891035149869862035944819604583319338590689304235550687135651707022925589407940921933185390320443890394536873365575441692374169030955598075134280924752047390130262218792865986787433083401814583070256474678595820081914893331856395013243738823578192724708657445960670497716010215037867202061822674568038069191783281832585996655909283453376893974941042094895097040443731594886504491321773447937548353360505545870347413798645587842403533283813838758293873496939938506342333359442707060523850938838591167838173742952354493440200853859066212775790231618017677041726159286010069658828513168371507342606764055746142044305135464202439709383361933001507404889278715443907623248244509418443340817122102107981732361049513848676566490157086383252387160938588261038378478828840374238880572729551113932577276961630834307967225615135756556390610802382912153121417461537118055054887172729663483974968524303134137250161429034724238278396845038249260064087461828722458568657299051099223293057334579816844913362114526542406750021892536789804227088391918860978222924490951830816005142499668447857708948298972331937318637153136352444636173106834845289576366063787304845101537799272392752034325809053594561587270696051999743295994590717478067064983317097621660815078290181480733944366653976513505868490837972584249407882115897891032432068054692530111488955315215275085148949905198812788662139227371796961991483170175388735117715618516516593082187999202159143295486648415318087381391583836210096193483644264972073802642449081973652790693801947084344690780924113641598941451936652492127257559144771554768141186831078111439244485256519914284445264205876593654848535877189454847042813276300911126860576513560141273643421785888925457990612652603340535483225737622405051125849477407411669735297753193234545729091860567086786573744501469111572460286652771415569729547182244698334244680621601325319015774932955080192162342783261337547043763222386012423255929330002137878207743365773788497465602211049785647588187072893005114368314557412457581438313007198107312577863541986784191904847014177558473614040979356249382088650968011260969484062430984185406079913654106954786486412867524544745825222092074204134702024444032866061095992975132709358433915215362320953972188872867638494520460784810121452867240925972173518257439937565179924583802470965203464080575142650947642992612026722166097533056008189803689908958725332734834949578348014572692216087294545355013823504665835997023240378542904381284663215794517638887512146471714418322132956577924288068510892828947721784203657223044574435844363631224348012250861616962318911812209553763853105735751158674398631000596766494614395245783222031994594903050745264680628057839687568335834964651563589305430599930024273975991109045649313681951457642384765347598549528359585108465731253886984911996779346168555080322487380869841327077568130942189186096653965119739682220260919397021772933680534621590867892581862293947274033699254426726016983326738074894903751976841555543955621749052943826845405816809655066296421295324864005885785102507411288024309931988192543949927105750528041343502737444453344038480706393359934495583606512903096051016162543738370786063460371810870458399102944630495841885162340149567983496716280826231245820184451950739546486040315931326413177155500613547542269518133900522587011425248523753599160310346403297448415202911239264514127369885032064435358490552604131192280381266599400775205048987596735950640955949522827376905212190873343108955722824782447712471476206129623616506128613655178259512005264049982130507116388008515708002278328960714944502002209161979661169777683126894254084278943515351833703556802751734763597735291238769029423307217591367864139407804883670738800625946816224609689541061964850167226897841665070631907924103102327396350567375344473787582913761907032712681990734309900867029549146831521163018468989791734036986814383491965091958373925172255662369340544492696345728658620270144799019929898678283126323745466585593771818799428070720794962529625393795364657285135684437111767987824444419767516696440398019369298752547174259492574996309292866494457430887578487182429571713948062012392905869431463228382728234020866001073087095762022663471955257652369817260978025865832168204394978803402554407414627938131400775152143768058466926711862554768917309824529795156397295222164680108509496575487865267040279561402398434989111245192418257990568086961040312396811565522117274738833096519125628811603991951580909567892726846611577832251083953169305626391968953797662117003527085268492298923224247090505794634225735782125010060004759361701969808941052020910063750957322352346266224855109528881318604425497001838028990705643748524174743691957923083307213944296648779770539257040815901162240100346827183770783359638326019399106134966874599867622151096267032757723926413308185422394911811043779840486872209104367379031203030321054677803884187910391508936241709822987998617378297239468413765389026144578371290348988714599174519290316962009438142723410341463628037440919326599366367231207733887839672123615209776892370198090982268105003853464407403440494204842308798794162940200284020763082844627633978050913393894146367028891547616668181804046257539368265664879306194483382959573234065999186658534147928455916308274167062444343962827927880294656633774443074417132708409516099044268472924020893366995879046482365429451146576976101697910754243036621294576276401246100755970789339675400189104501832268530841627265547194576942332350970773857849151214242828151723811319489908306031897776844963840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

def errb(s: str, *args):
    print(s, *args, file=stderr)
    exit(84)

def p_help():
    print("USAGE", "    ./203hotline [n k | d]",
          "DESCRIPTION",
          "    n	n value for the computation of C(n, k)",
          "    k	k value for the computation of C(n, k)",
          "    d	average duration of calls (in seconds",
          sep="\n", end="\n")
    exit(0)

# bottlenecc; need either CFFI or fast memoization
def hfac(a):
    if a == 3500:
        return FAC_3500
    return factorial(a)

def sfactorial(a, b):
    return hfac(a) / (hfac(b) * hfac(a - b))

def c(i: int):
    return (i + 1) % 5 and i < 50


def p_bino(a, calls = 3500, hrs = 8, phones = 25):
    pa = a / (60 * 60 * hrs)
    start = time()
    overload = 0

    print("Binomial distribution:")
    for i in range(51):
        val = sfactorial(calls, i) * (pa ** i) * ((1 - pa) ** (calls - i))
        print(i, " -> ", "{:.3f}".format(val),
                "\t" if c(i) else "\n", sep='', end='')
        if i > phones:
            overload += val

    if a > 320:
        overload = 1
    print("Overload: {:.1f}%".format(overload * 100))
    print("Computation time: {:.2f} ms".format((time() - start) * 1000))


def p_poisson(a, calls = 3500, hrs = 8, phones = 25):
    def poisson(a, b):
        return (exp(-b) * b**a) / factorial(a)

    pa = calls * (a / (60 * 60 * hrs))
    start = time()
    overload = 0

    print("Poisson distribution:")
    for i in range(51):
        val = poisson(i, pa)
        print(i, " -> ", "{:.3f}".format(val),
                "\t" if c(i) else "\n", sep='', end='')
        if i > phones:
            overload += val

    if a > 320:
        overload = 1
    print("Overload: {:.1f}%".format(overload * 100))
    print("Computation time: {:.2f} ms".format((time() - start) * 1000))


def p_combo(a, b):
    print(b, "-combinations of a set of size ", a, ":", sep='')
    print("{}".format(sfactorial(a, b)))


if __name__ == "__main__":
    try:
        if len(argv) != 2 and len(argv) != 3:
            raise LookupError("invalid number of arguments")
        if len(argv) == 2 and argv[1] == "-h":
            p_help()
        a = int(argv[1])
        if a <= 0:
            raise ValueError("first argument must be positive under 64000")
        if len(argv) == 3:
            b = int(argv[2])
            if b <= 0 or a < b:
                raise ValueError("second argument must be positive under first")
    except Exception as e:
        errb(e)
    if len(argv) == 2:
        p_bino(a)
        print()
        p_poisson(a)
        exit(0)
    elif len(argv) == 3:
        p_combo(a, b)
        exit(0)
    else:
        errb("wadduhek")
